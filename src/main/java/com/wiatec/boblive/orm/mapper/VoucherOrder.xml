<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.wiatec.boblive.orm.dao.voucher.VoucherOrderDao">

    <sql id="select">
        SELECT id, mac, voucher_id, transaction_id, price, amount, currency, auth, create_time, status
        FROM voucher_order
    </sql>

    <select id="selectAll" resultType="com.wiatec.boblive.orm.pojo.voucher.VoucherOrderInfo">
        <include refid="select"/>
    </select>

    <select id="selectByMacAndVoucherId" resultType="com.wiatec.boblive.orm.pojo.voucher.VoucherOrderInfo">
        <include refid="select"/>
        WHERE mac = #{mac}
              AND voucher_id = #{voucherId}
              AND status = 0
    </select>

    <insert id="insertOne" parameterType="com.wiatec.boblive.orm.pojo.voucher.VoucherOrderInfo">
        INSERT IGNORE INTO voucher_order (mac, voucher_id, transaction_id, price, amount, currency, auth)
        VALUES (#{mac}, #{voucherId}, #{transactionId}, #{price},  #{amount}, #{currency}, #{auth})
    </insert>

    <update id="updateStatusToConfirm">
        UPDATE voucher_order
        SET status = 1
        WHERE mac = #{mac}
    </update>

</mapper>